<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="/Bootstrap5/bootstrap-5.1.3-dist/css/bootstrap.min.css" />
    <script src="/Bootstrap5/bootstrap-5.1.3-dist/js/bootstrap.bundle.min.js"></script>
    <style>
        .container {
            width: 300px;
            height: 300px;
            border: 1px solid red;
        }

        form {

            display: flex;
            flex-direction: column;
        }

       .container > h2 {
            text-align: center;
        }

        button {
            width: 100px;
        }

        .container form > span {
            text-align: center;
            /* position: absolute; */
            color: red;
            display: none;
        }
        .btt {
            text-align: center;
        }
    </style>
</head>

<body>
    <div class="container mt-3">
        <h2>登录</h2>
        <form action="#" >
            <span class="error">用户名或者密码错误！</span>
            <div class="mb-3 mt-3">
                <label for="text" class="form-label">用户名:</label>
                <input type="text" class="form-control" id="username" placeholder="user" name="user">
            </div>
            <div class="mb-3">
                <label for="pwd" class="form-label">密码:</label>
                <input type="password" class="form-control" id="pwd" placeholder="Enter password" name="pswd">
            </div>
            <div class="btt">
                <input type="submit" class="btn btn-danger" >
            </div>
        </form>
    </div>
    <!-- <script>
        function myFunction(){
            alert('登录');
        }
    </script> -->
    <script>
        var loginForm = document.querySelector('form');
        var nameInp = document.querySelector('#username');
        var pwdInp = document.querySelector('#pwd');
        var errBox = document.querySelector('.error');
        // console.log(errBox);
        // 1. form 标签绑定一个表单提交事件
        loginForm.onsubmit = function (e) {
            // alert('你好');
            //阻止表单的默认提交行为
            // e.preverntDefault();

            // 2. 拿到填写的用户和密码
            var name = nameInp.value;
            var pwd = pwdInp.value;

            // console.log(name, pwd);
            // 2-2 验证用户名和密码

            if (!name || !pwd) return alert('请完整填写表单');

            // //3. 发送ajax 请求
            var xhr = new XMLHttpRequest();
            xhr.open('POST', 'http://192.168.64.1:8099/', true)
            xhr.onload = function () {
                var res = (JSON.parse(xhr.responseText));
                console.log(res);
            }
            // 进行条件判断
                if(res.code === 0){
                    //登录失败
                    errBox.style.display = 'block';
                }else{
                    //登录成功了
                    window.location.href = '#';
                }

            xhr.setRequestHeader('content-type', 'appliction/x-www-form-urlencoded')
            xhr.send('name=nihoa&age=18');
        }
    </script>
</body>

</html>